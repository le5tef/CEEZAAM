# ui-sezam

Фронтенд админки Sezam на TypeScript + [Vue 3](https://v3.nuxtjs.org/),
[Pinia](https://pinia.vuejs.org/) и [Element Plus UI](https://element-plus.org/)

localhost: [https://local.dev13.ru](https://local.dev13.ru)

stage: [https://sz.dev13.ru](https://sz.dev13.ru)

prod: []()

&nbsp;

## Общие шаги для разработки и деплоя

### 0. Установите зависимости

Node.js должен иметь версию, указанную в файле `.nvmrc`. Для удобного переключения между версиями
Node.js можно использовать [nvm](https://github.com/nvm-sh/nvm). **Важно**: в качестве менеджера
пакетов используйте [yarn](https://yarnpkg.com/), а не `npm`, так как гарантией установки
зависимостей с проверенными версиями является файл `yarn.lock`. Установка зависимостей производится
одной командой:

```
yarn
```

&nbsp;

## Деплой

### 1. Настройте веб-сервер

nginx

```
location / {
  try_files $uri $uri/ /index.html;
}
```

### 2. Настройте ENV-переменные

Приложение не сможет работаеть без env-переменных. Переменные задаются в веб-интерфейсе gitlab:
Settings > CI/CD > Variables. Все env-переменные должны иметь префикс `SZ_` и быть доступными
через `process.env` во время сборки.

### 3. Сбилдите приложение

Команда:

```
yarn build
```

Вот и всё — готовые файлы лежат в директории `/dist`. Точка входа
`/dist/index.html`.

&nbsp;

## Разработка на локальном компе

### 1. Настройте локальный домен

Домен `https://local.dev13.ru` должен ссылаться на ваш локалхост. Для этого отредактируйте
`hosts`-файл (понадобятся права администратора):

```
sudo nano /etc/hosts
```

и добавьте в самый низ строки

```
127.0.0.1 local.dev13.ru
```

### 2. Создайте SSL-сертификаты

Локальный домен использует `https` — так надо для корректной работы всех интеграций (например Apple
Auth). Что бы всё завелось нам нужен сертификат. Выполните команду `yarn cert`, которая
выполнит нужный bash-скрипт (протестировано на macOS Big Sur 11.2.2). Потребуются права
администратора. Без готовых сертификатов дев-сервер не запустится.

### 3. Настройте ENV-переменные

Скопируйте файл `.env.example` в корень проекта и переименуйте в `.env`, что бы приложение получило
все необходимые переменные в `process.env`. Все env-переменные должны иметь префикс `SZ_`.
Команда:

```
cp .env.example .env
```

При изменении значений переменных в env-файле придется перезапустить сервер.

### 4. Запустите локальный dev-server

```
yarn dev
```

И откройте в браузере [https://local.dev13.ru](https://local.dev13.ru)

&nbsp;

![Вся суть](https://pbs.twimg.com/media/Ehw9hCvWAAUF8ct.jpg)
